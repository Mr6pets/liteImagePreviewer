# ä¸»é¢˜ç®¡ç†

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**  
- [themes.js](file://themes.js)
- [src/scss/_variables.scss](file://src/scss/_variables.scss)
- [src/scss/_base.scss](file://src/scss/_base.scss)
- [index.html](file://index.html)
- [js/ui.js](file://js/ui.js)
- [js/core.js](file://js/core.js)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [ä¸»é¢˜æ•°æ®ç»“æ„è®¾è®¡](#ä¸»é¢˜æ•°æ®ç»“æ„è®¾è®¡)
3. [ä¸»é¢˜ç®¡ç†æœºåˆ¶](#ä¸»é¢˜ç®¡ç†æœºåˆ¶)
4. [æ·±è‰²ä¸æµ…è‰²æ¨¡å¼å®ç°](#æ·±è‰²ä¸æµ…è‰²æ¨¡å¼å®ç°)
5. [ä¸»é¢˜åˆ‡æ¢è§¦å‘æ–¹å¼](#ä¸»é¢˜åˆ‡æ¢è§¦å‘æ–¹å¼)
6. [DOMåº”ç”¨è¿‡ç¨‹](#domåº”ç”¨è¿‡ç¨‹)
7. [å¯æ‰©å±•æ€§ä¸è‡ªå®šä¹‰ä¸»é¢˜](#å¯æ‰©å±•æ€§ä¸è‡ªå®šä¹‰ä¸»é¢˜)
8. [UIåŒæ­¥æ›´æ–°æœºåˆ¶](#uiåŒæ­¥æ›´æ–°æœºåˆ¶)
9. [è°ƒè¯•æ–¹æ³•ä¸å¸¸è§é—®é¢˜](#è°ƒè¯•æ–¹æ³•ä¸å¸¸è§é—®é¢˜)
10. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#æ€§èƒ½ä¼˜åŒ–å»ºè®®)

## ç®€ä»‹
`liteImagePreviewer` é€šè¿‡ `ThemeManager` ç±»å®ç°äº†ä¸€å¥—å®Œæ•´çš„ä¸»é¢˜ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§è§†è§‰ä¸»é¢˜ï¼ˆåŒ…æ‹¬é»˜è®¤ã€æš—é»‘ã€æµ·æ´‹ã€æ—¥è½ã€æ£®æ—ç­‰ï¼‰ï¼Œå¹¶å…è®¸ç”¨æˆ·é€šè¿‡ç•Œé¢äº¤äº’æˆ–ç³»ç»Ÿåå¥½è¿›è¡Œä¸»é¢˜åˆ‡æ¢ã€‚è¯¥ç³»ç»ŸåŸºäºCSSå˜é‡åŠ¨æ€æ›´æ–°ç•Œé¢æ ·å¼ï¼Œç¡®ä¿ä¸»é¢˜åˆ‡æ¢æµç•…ä¸”ä¸å½±å“ç”¨æˆ·ä½“éªŒã€‚

**Section sources**  
- [themes.js](file://themes.js#L1-L365)
- [index.html](file://index.html#L1-L165)

## ä¸»é¢˜æ•°æ®ç»“æ„è®¾è®¡
ä¸»é¢˜ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯ `themes` å¸¸é‡å¯¹è±¡ï¼Œå®ƒå®šä¹‰äº†æ‰€æœ‰å¯ç”¨ä¸»é¢˜çš„é…ç½®ã€‚æ¯ä¸ªä¸»é¢˜åŒ…å«åç§°ã€å›¾æ ‡å’Œé¢œè‰²å˜é‡é›†åˆï¼Œç»“æ„æ¸…æ™°ä¸”æ˜“äºæ‰©å±•ã€‚

```js
const themes = {
    default: {
        name: 'é»˜è®¤ä¸»é¢˜',
        icon: 'ğŸŒˆ',
        colors: {
            primary: '#667eea',
            secondary: '#764ba2',
            accent: '#f093fb',
            background: 'linear-gradient(...)',
            cardBg: 'rgba(255, 255, 255, 0.95)',
            textPrimary: '#2d3748',
            textSecondary: '#718096'
        }
    },
    // å…¶ä»–ä¸»é¢˜...
};
```

è¿™ç§è®¾è®¡å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š
- **æ¨¡å—åŒ–**ï¼šæ¯ä¸ªä¸»é¢˜ç‹¬ç«‹å®šä¹‰ï¼Œä¾¿äºç»´æŠ¤ã€‚
- **ä¸€è‡´æ€§**ï¼šç»Ÿä¸€çš„é¢œè‰²å˜é‡å‘½åè§„èŒƒã€‚
- **å¯è¯»æ€§**ï¼šä½¿ç”¨ä¸­æ–‡åç§°å’Œemojiå›¾æ ‡æå‡å¯è¯†åˆ«æ€§ã€‚

**Section sources**  
- [themes.js](file://themes.js#L1-L45)

## ä¸»é¢˜ç®¡ç†æœºåˆ¶
`ThemeManager` ç±»è´Ÿè´£ä¸»é¢˜çš„åˆå§‹åŒ–ã€åˆ‡æ¢å’ŒæŒä¹…åŒ–ã€‚å…¶æ„é€ å‡½æ•°ä» `localStorage` ä¸­è¯»å–ä¸Šæ¬¡é€‰æ‹©çš„ä¸»é¢˜ï¼Œè‹¥æ— è®°å½•åˆ™ä½¿ç”¨é»˜è®¤ä¸»é¢˜ã€‚

```mermaid
classDiagram
class ThemeManager {
+currentTheme : string
+constructor()
+init() : void
+createThemeSelector() : void
+applyTheme(themeKey : string) : void
+switchTheme(themeKey : string) : void
+updateThemeSelectorStyles(themeKey : string, theme : object) : void
+getTitleGradient(colors : object, themeKey : string) : string
}
ThemeManager --> themes : "å¼•ç”¨"
ThemeManager --> localStorage : "è¯»å†™"
ThemeManager --> document.documentElement : "æ›´æ–°CSSå˜é‡"
```

**Diagram sources**  
- [themes.js](file://themes.js#L68-L365)

**Section sources**  
- [themes.js](file://themes.js#L68-L365)

## æ·±è‰²ä¸æµ…è‰²æ¨¡å¼å®ç°
ç³»ç»Ÿé€šè¿‡ `themes.dark` æ˜ç¡®å®ç°äº†æ·±è‰²æ¨¡å¼ï¼Œå…¶é¢œè‰²é…ç½®é’ˆå¯¹æš—èƒŒæ™¯è¿›è¡Œäº†ä¼˜åŒ–ï¼š

```js
dark: {
    name: 'æš—é»‘ä¸»é¢˜',
    icon: 'ğŸŒ™',
    colors: {
        primary: '#1a202c',
        secondary: '#2d3748',
        accent: '#4a5568',
        background: 'linear-gradient(135deg, #1a202c 0%, #2d3748 50%, #4a5568 100%)',
        cardBg: 'rgba(45, 55, 72, 0.95)',
        textPrimary: '#f7fafc',
        textSecondary: '#e2e8f0'
    }
}
```

æµ…è‰²æ¨¡å¼ç”± `themes.default` æä¾›ï¼ŒèƒŒæ™¯æ˜äº®ï¼Œæ–‡å­—é¢œè‰²è¾ƒæ·±ï¼Œé€‚åˆå¸¸è§„ä½¿ç”¨åœºæ™¯ã€‚

**Section sources**  
- [themes.js](file://themes.js#L20-L35)

## ä¸»é¢˜åˆ‡æ¢è§¦å‘æ–¹å¼
ä¸»é¢˜åˆ‡æ¢å¯é€šè¿‡ä¸¤ç§æ–¹å¼è§¦å‘ï¼š

1. **ç”¨æˆ·ç‚¹å‡»æŒ‰é’®**ï¼šåœ¨é¡µé¢å³ä¸Šè§’çš„â€œä¸»é¢˜é€‰æ‹©å™¨â€ä¸­ç‚¹å‡»ä¸åŒä¸»é¢˜é€‰é¡¹ã€‚
2. **ç¨‹åºè°ƒç”¨**ï¼šé€šè¿‡ `ThemeManager.switchTheme(themeKey)` æ–¹æ³•ç¼–ç¨‹å¼åˆ‡æ¢ã€‚

äº‹ä»¶ç»‘å®šåœ¨ `createThemeSelector` æ–¹æ³•ä¸­å®Œæˆï¼Œç›‘å¬ `.theme-option` æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼š

```js
themeSelector.addEventListener('click', (e) => {
    if (e.target.closest('.theme-option')) {
        const themeKey = e.target.closest('.theme-option').dataset.theme;
        this.switchTheme(themeKey);
    }
});
```

**Section sources**  
- [themes.js](file://themes.js#L145-L147)

## DOMåº”ç”¨è¿‡ç¨‹
ä¸»é¢˜åˆ‡æ¢æ—¶ï¼Œ`applyTheme` æ–¹æ³•ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

1. **æ›´æ–°CSSå˜é‡**ï¼šé€šè¿‡ `document.documentElement.style.setProperty()` è®¾ç½®æ ¹å…ƒç´ çš„CSSå˜é‡ã€‚
2. **æ›´æ–°èƒŒæ™¯**ï¼šç›´æ¥ä¿®æ”¹ `document.body.style.background`ã€‚
3. **æ›´æ–°æ ‡é¢˜æ ·å¼**ï¼šä¸ºæ ‡é¢˜åº”ç”¨æ¸å˜æ•ˆæœå’Œé€æ˜æ–‡å­—ã€‚
4. **æ›´æ–°ä¸»é¢˜é€‰æ‹©å™¨è‡ªèº«æ ·å¼**ï¼šæ ¹æ®å½“å‰ä¸»é¢˜è°ƒæ•´æŒ‰é’®å’Œä¸‹æ‹‰èœå•çš„èƒŒæ™¯ã€è¾¹æ¡†å’Œæ–‡å­—é¢œè‰²ã€‚

```mermaid
sequenceDiagram
participant ç”¨æˆ·
participant ä¸»é¢˜æŒ‰é’®
participant ThemeManager
participant DOM
ç”¨æˆ·->>ä¸»é¢˜æŒ‰é’® : ç‚¹å‡»ä¸»é¢˜é€‰é¡¹
ä¸»é¢˜æŒ‰é’®->>ThemeManager : è°ƒç”¨switchTheme()
ThemeManager->>ThemeManager : æ›´æ–°currentTheme
ThemeManager->>localStorage : ä¿å­˜ä¸»é¢˜
ThemeManager->>ThemeManager : è°ƒç”¨applyTheme()
ThemeManager->>DOM : è®¾ç½®CSSå˜é‡
ThemeManager->>DOM : æ›´æ–°bodyèƒŒæ™¯
ThemeManager->>DOM : æ›´æ–°æ ‡é¢˜æ ·å¼
ThemeManager->>DOM : æ›´æ–°é€‰æ‹©å™¨æ ·å¼
ThemeManager->>DOM : è§¦å‘åŠ¨ç”»
```

**Diagram sources**  
- [themes.js](file://themes.js#L190-L259)

**Section sources**  
- [themes.js](file://themes.js#L190-L259)

## å¯æ‰©å±•æ€§ä¸è‡ªå®šä¹‰ä¸»é¢˜
ç³»ç»Ÿè®¾è®¡å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼š

- **æ–°å¢ä¸»é¢˜**ï¼šåªéœ€åœ¨ `themes` å¯¹è±¡ä¸­æ·»åŠ æ–°çš„ä¸»é¢˜é”®å€¼å¯¹ã€‚
- **è‡ªå®šä¹‰ç°æœ‰ä¸»é¢˜**ï¼šä¿®æ”¹å¯¹åº”ä¸»é¢˜çš„é¢œè‰²å€¼å³å¯ã€‚
- **æ”¯æŒCSSå˜é‡**ï¼šSCSSæ–‡ä»¶ä¸­å®šä¹‰äº† `:root` å˜é‡ï¼Œä¸JavaScriptåŠ¨æ€æ›´æ–°å…¼å®¹ã€‚

ä¾‹å¦‚ï¼Œæ·»åŠ æ–°ä¸»é¢˜åªéœ€ï¼š

```js
themes.newTheme = {
    name: 'æ–°ä¸»é¢˜',
    icon: 'âœ¨',
    colors: { /* é¢œè‰²é…ç½® */ }
};
```

**Section sources**  
- [themes.js](file://themes.js#L1-L365)
- [src/scss/_variables.scss](file://src/scss/_variables.scss#L45-L60)

## UIåŒæ­¥æ›´æ–°æœºåˆ¶
ä¸»é¢˜åˆ‡æ¢åï¼ŒUIç»„ä»¶é€šè¿‡ä»¥ä¸‹æ–¹å¼åŒæ­¥æ›´æ–°ï¼š

- **CSSå˜é‡é©±åŠ¨**ï¼šæ‰€æœ‰ä½¿ç”¨ `var(--primary-color)` ç­‰å˜é‡çš„æ ·å¼è‡ªåŠ¨æ›´æ–°ã€‚
- **åŠ¨æ€æ ·å¼æ³¨å…¥**ï¼šä¸»é¢˜é€‰æ‹©å™¨çš„æ ·å¼åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå¹¶æ›´æ–°ã€‚
- **DOMå±æ€§æ›´æ–°**ï¼šå¦‚æ ‡é¢˜çš„ `style.background` ç›´æ¥ä¿®æ”¹ã€‚

æ­¤å¤–ï¼Œ`switchTheme` æ–¹æ³•è¿˜ä¼šæ›´æ–°æŒ‰é’®å›¾æ ‡å’Œæ´»åŠ¨çŠ¶æ€ï¼š

```js
// æ›´æ–°æŒ‰é’®å›¾æ ‡
const themeIcon = document.querySelector('.theme-icon');
themeIcon.textContent = themes[themeKey].icon;

// æ›´æ–°æ´»åŠ¨çŠ¶æ€
option.classList.toggle('active', option.dataset.theme === themeKey);
```

**Section sources**  
- [themes.js](file://themes.js#L339-L364)

## è°ƒè¯•æ–¹æ³•ä¸å¸¸è§é—®é¢˜
### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|--------|---------|
| ä¸»é¢˜åˆ‡æ¢æ— æ•ˆ | localStorage è¢«ç¦ç”¨ | æ£€æŸ¥æµè§ˆå™¨éšç§è®¾ç½® |
| æ ·å¼æœªæ›´æ–° | CSSå˜é‡æœªæ­£ç¡®å¼•ç”¨ | ç¡®ä¿ä½¿ç”¨ `var(--variable)` |
| ç•Œé¢é—ªçƒ | è¿‡æ¸¡åŠ¨ç”»å†²çª | æ£€æŸ¥ `transition` å±æ€§è®¾ç½® |
| å›¾æ ‡ä¸æ˜¾ç¤º | å­—ä½“æˆ–emojiæ”¯æŒé—®é¢˜ | ç¡®ä¿ç³»ç»Ÿæ”¯æŒemojiæ¸²æŸ“ |

### è°ƒè¯•æ–¹æ³•
1. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ£€æŸ¥ `:root` çš„CSSå˜é‡å€¼ã€‚
2. æŸ¥çœ‹ `localStorage` ä¸­ `selectedTheme` çš„å€¼ã€‚
3. åœ¨æ§åˆ¶å°æ‰‹åŠ¨è°ƒç”¨ `new ThemeManager().switchTheme('dark')` æµ‹è¯•ã€‚

**Section sources**  
- [themes.js](file://themes.js#L339-L364)
- [js/core.js](file://js/core.js#L27)

## æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. **å‡å°‘é‡æ’é‡ç»˜**ï¼šä½¿ç”¨CSSå˜é‡è€Œéç›´æ¥ä¿®æ”¹å¤šä¸ªæ ·å¼å±æ€§ã€‚
2. **é¿å…é¢‘ç¹DOMæ“ä½œ**ï¼šå°†æ ·å¼æ³¨å…¥é›†ä¸­å¤„ç†ã€‚
3. **ä½¿ç”¨è¿‡æ¸¡åŠ¨ç”»**ï¼šæ·»åŠ å¹³æ»‘çš„ `transition` æ•ˆæœæå‡ä½“éªŒã€‚
4. **å»¶è¿Ÿæ ·å¼è®¡ç®—**ï¼šå¯¹äºå¤æ‚æ ·å¼ï¼Œå¯ä½¿ç”¨ `requestAnimationFrame`ã€‚

å½“å‰å®ç°å·²åŒ…å«æ€§èƒ½ä¼˜åŒ–ï¼š
```js
document.body.style.transition = 'all 0.5s ease';
setTimeout(() => {
    document.body.style.transition = '';
}, 500);
```

**Section sources**  
- [themes.js](file://themes.js#L358-L363)